package test

import (
	"fmt"
	"github.com/coastsee/logpush"
	"github.com/coastsee/logpush/engines"
	"testing"
	"time"
)

var testData = []string{
	`{"level":"INFO","ts":"2022-06-18 10:45:01","file":"gin@v1.7.4/context.go:165","msg":"/api/wechat_mp","status":200,"method":"POST","path":"/api/wechat_mp","query":"signature=88df4d6b46f61a085fe89836b84275f805b30c&timestamp=1655520301&nonce=1830400737&openid=oo5TywvvbagxO6TGpeTYa0o","ip":"81.69.103.0","user-agent":"Mozilla/4.0","time":"2022-06-18T02:45:01Z","latency":160,"trackId":"9745f19f-e928-4256-9400-864053ace90d"}`,
	`{"level":"INFO","ts":"2022-06-18 10:45:01","file":"gin@v1.7.4/context.go:165","msg":"/api/wechat_mp","status":200,"method":"POST","path":"/api/wechat_mp","query":"signature=88df4d6b46f61a085fe89836b84275f805b30c&timestamp=1655520301&nonce=1830400737&openid=oo5TywvvbagxO6TGpeTYa0o","ip":"81.69.103.0","user-agent":"Mozilla/4.0","time":"2022-06-18T02:45:01Z","latency":160,"trackId":"9745f19f-e928-4256-9400-864053ace90d"}`,
	`{"level":"INFO","ts":"2022-06-18 10:45:01","file":"gin@v1.7.4/context.go:165","msg":"/api/wechat_mp","status":200,"method":"POST","path":"/api/wechat_mp","query":"signature=88df4d6b46f61a085fe89836b84275f805b30c&timestamp=1655520301&nonce=1830400737&openid=oo5TywvvbagxO6TGpeTYa0o","ip":"81.69.103.0","user-agent":"Mozilla/4.0","time":"2022-06-18T02:45:01Z","latency":160,"trackId":"9745f19f-1111-4256-9400-864053ace90d"}`,
	`{"level":"INFO","ts":"2022-06-18 10:45:01","file":"gin@v1.7.4/context.go:165","msg":"/api/wechat_mp","status":200,"method":"POST","path":"/api/wechat_mp","query":"signature=88df4d6b46f61a085fe89836b84275f805b30c&timestamp=1655520301&nonce=1830400737&openid=oo5TywvvbagxO6TGpeTYa0o","ip":"81.69.103.0","user-agent":"Mozilla/4.0","time":"2022-06-18T02:45:01Z","latency":160,"trackId":"9745f19f-e928-4256-9400-864053ace90d"}`,
	`{"level":"INFO","ts":"2022-06-18 10:45:01","file":"gin@v1.7.4/context.go:165","msg":"/api/wechat_mp","status":200,"method":"POST","path":"/api/wechat_mp","query":"signature=88df4d6b46f61a085fe89836b84275f805b30c&timestamp=1655520301&nonce=1830400737&openid=oo5TywvvbagxO6TGpeTYa0o","ip":"81.69.103.0","user-agent":"Mozilla/4.0","time":"2022-06-18T02:45:01Z","latency":160,"trackId":"9745f19f-e928-4256-9400-864053ace90d"}`,
	`{"level":"INFO","ts":"2022-06-18 10:45:01","file":"gin@v1.7.4/context.go:165","msg":"/api/wechat_mp","status":200,"method":"POST","path":"/api/wechat_mp","query":"signature=88df4d6b46f61a085fe89836b84275f805b30c&timestamp=1655520301&nonce=1830400737&openid=oo5TywvvbagxO6TGpeTYa0o","ip":"81.69.103.0","user-agent":"Mozilla/4.0","time":"2022-06-18T02:45:01Z","latency":160,"trackId":"9745f19f-2222-4256-9400-864053ace90d"}`,
	`{"level":"INFO","ts":"2022-06-18 10:45:01","file":"gin@v1.7.4/context.go:165","msg":"/api/wechat_mp","status":200,"method":"POST","path":"/api/wechat_mp","query":"signature=88df4d6b46f61a085fe89836b84275f805b30c&timestamp=1655520301&nonce=1830400737&openid=oo5TywvvbagxO6TGpeTYa0o","ip":"81.69.103.0","user-agent":"Mozilla/4.0","time":"2022-06-18T02:45:01Z","latency":160,"trackId":"9745f19f-e928-4256-9400-864053ace90d"}`,
	`{"level":"INFO","ts":"2022-06-18 10:45:01","file":"gin@v1.7.4/context.go:165","msg":"/api/wechat_mp","status":200,"method":"POST","path":"/api/wechat_mp","query":"signature=88df4d6b46f61a085fe89836b84275f805b30c&timestamp=1655520301&nonce=1830400737&openid=oo5TywvvbagxO6TGpeTYa0o","ip":"81.69.103.0","user-agent":"Mozilla/4.0","time":"2022-06-18T02:45:01Z","latency":160,"trackId":"9745f19f-e928-4256-9400-864053ace90d"}`,
	`{"level":"INFO","ts":"2022-06-18 10:45:01","file":"gin@v1.7.4/context.go:165","msg":"/api/wechat_mp","status":200,"method":"POST","path":"/api/wechat_mp","query":"signature=88df4d6b46f61a085fe89836b84275f805b30c&timestamp=1655520301&nonce=1830400737&openid=oo5TywvvbagxO6TGpeTYa0o","ip":"81.69.103.0","user-agent":"Mozilla/4.0","time":"2022-06-18T02:45:01Z","latency":160,"trackId":"9745f19f-3333-4256-9400-864053ace90d"}`,
	`{"level":"INFO","ts":"2022-06-18 10:45:01","file":"gin@v1.7.4/context.go:165","msg":"/api/wechat_mp","status":200,"method":"POST","path":"/api/wechat_mp","query":"signature=88df4d6b46f61a085fe89836b84275f805b30c&timestamp=1655520301&nonce=1830400737&openid=oo5TywvvbagxO6TGpeTYa0o","ip":"81.69.103.0","user-agent":"Mozilla/4.0","time":"2022-06-18T02:45:01Z","latency":160,"trackId":"9745f19f-e928-4256-9400-864053ace90d"}`,
	`{"level":"INFO","ts":"2022-06-18 10:45:01","file":"gin@v1.7.4/context.go:165","msg":"/api/wechat_mp","status":200,"method":"POST","path":"/api/wechat_mp","query":"signature=88df4d6b46f61a085fe89836b84275f805b30c&timestamp=1655520301&nonce=1830400737&openid=oo5TywvvbagxO6TGpeTYa0o","ip":"81.69.103.0","user-agent":"Mozilla/4.0","time":"2022-06-18T02:45:01Z","latency":160,"trackId":"9745f19f-e928-4256-9400-864053ace90d"}`,
	`{"level":"INFO","ts":"2022-06-18 10:45:01","file":"gin@v1.7.4/context.go:165","msg":"/api/wechat_mp","status":200,"method":"POST","path":"/api/wechat_mp","query":"signature=88df4d6b46f61a085fe89836b84275f805b30c&timestamp=1655520301&nonce=1830400737&openid=oo5TywvvbagxO6TGpeTYa0o","ip":"81.69.103.0","user-agent":"Mozilla/4.0","time":"2022-06-18T02:45:01Z","latency":160,"trackId":"9745f19f-4444-4256-9400-864053ace90d"}`,
	`{"level":"INFO","ts":"2022-06-18 10:45:01","file":"gin@v1.7.4/context.go:165","msg":"/api/wechat_mp","status":200,"method":"POST","path":"/api/wechat_mp","query":"signature=88df4d6b46f61a085fe89836b84275f805b30c&timestamp=1655520301&nonce=1830400737&openid=oo5TywvvbagxO6TGpeTYa0o","ip":"81.69.103.0","user-agent":"Mozilla/4.0","time":"2022-06-18T02:45:01Z","latency":160,"trackId":"9745f19f-e928-4256-9400-864053ace90d"}`,
	`{"level":"INFO","ts":"2022-06-18 10:45:01","file":"gin@v1.7.4/context.go:165","msg":"/api/wechat_mp","status":200,"method":"POST","path":"/api/wechat_mp","query":"signature=88df4d6b46f61a085fe89836b84275f805b30c&timestamp=1655520301&nonce=1830400737&openid=oo5TywvvbagxO6TGpeTYa0o","ip":"81.69.103.0","user-agent":"Mozilla/4.0","time":"2022-06-18T02:45:01Z","latency":160,"trackId":"9745f19f-e928-4256-9400-864053ace90d"}`,
	`{"level":"INFO","ts":"2022-06-18 10:45:01","file":"gin@v1.7.4/context.go:165","msg":"/api/wechat_mp","status":200,"method":"POST","path":"/api/wechat_mp","query":"signature=88df4d6b46f61a085fe89836b84275f805b30c&timestamp=1655520301&nonce=1830400737&openid=oo5TywvvbagxO6TGpeTYa0o","ip":"81.69.103.0","user-agent":"Mozilla/4.0","time":"2022-06-18T02:45:01Z","latency":160,"trackId":"9745f19f-5555-4256-9400-864053ace90d"}`,
	`{"level":"INFO","ts":"2022-06-18 10:45:01","file":"gin@v1.7.4/context.go:165","msg":"/api/wechat_mp","status":200,"method":"POST","path":"/api/wechat_mp","query":"signature=88df4d6b46f61a085fe89836b84275f805b30c&timestamp=1655520301&nonce=1830400737&openid=oo5TywvvbagxO6TGpeTYa0o","ip":"81.69.103.0","user-agent":"Mozilla/4.0","time":"2022-06-18T02:45:01Z","latency":160,"trackId":"9745f19f-e928-4256-9400-864053ace90d"}`,
	`{"level":"INFO","ts":"2022-06-18 10:45:01","file":"gin@v1.7.4/context.go:165","msg":"/api/wechat_mp","status":200,"method":"POST","path":"/api/wechat_mp","query":"signature=88df4d6b46f61a085fe89836b84275f805b30c&timestamp=1655520301&nonce=1830400737&openid=oo5TywvvbagxO6TGpeTYa0o","ip":"81.69.103.0","user-agent":"Mozilla/4.0","time":"2022-06-18T02:45:01Z","latency":160,"trackId":"9745f19f-e928-4256-9400-864053ace90d"}`,
	`{"level":"INFO","ts":"2022-06-18 10:45:01","file":"gin@v1.7.4/context.go:165","msg":"/api/wechat_mp","status":200,"method":"POST","path":"/api/wechat_mp","query":"signature=88df4d6b46f61a085fe89836b84275f805b30c&timestamp=1655520301&nonce=1830400737&openid=oo5TywvvbagxO6TGpeTYa0o","ip":"81.69.103.0","user-agent":"Mozilla/4.0","time":"2022-06-18T02:45:01Z","latency":160,"trackId":"9745f19f-6666-4256-9400-864053ace90d"}`,
	`{"level":"INFO","ts":"2022-06-18 10:45:01","file":"gin@v1.7.4/context.go:165","msg":"/api/wechat_mp","status":200,"method":"POST","path":"/api/wechat_mp","query":"signature=88df4d6b46f61a085fe89836b84275f805b30c&timestamp=1655520301&nonce=1830400737&openid=oo5TywvvbagxO6TGpeTYa0o","ip":"81.69.103.0","user-agent":"Mozilla/4.0","time":"2022-06-18T02:45:01Z","latency":160,"trackId":"9745f19f-e928-4256-9400-864053ace90d"}`,
	`{"level":"INFO","ts":"2022-06-18 10:45:01","file":"gin@v1.7.4/context.go:165","msg":"/api/wechat_mp","status":200,"method":"POST","path":"/api/wechat_mp","query":"signature=88df4d6b46f61a085fe89836b84275f805b30c&timestamp=1655520301&nonce=1830400737&openid=oo5TywvvbagxO6TGpeTYa0o","ip":"81.69.103.0","user-agent":"Mozilla/4.0","time":"2022-06-18T02:45:01Z","latency":160,"trackId":"9745f19f-e928-4256-9400-864053ace90d"}`,
	`{"level":"INFO","ts":"2022-06-18 10:45:01","file":"gin@v1.7.4/context.go:165","msg":"/api/wechat_mp","status":200,"method":"POST","path":"/api/wechat_mp","query":"signature=88df4d6b46f61a085fe89836b84275f805b30c&timestamp=1655520301&nonce=1830400737&openid=oo5TywvvbagxO6TGpeTYa0o","ip":"81.69.103.0","user-agent":"Mozilla/4.0","time":"2022-06-18T02:45:01Z","latency":160,"trackId":"9745f19f-7777-4256-9400-864053ace90d"}`,
	`{"level":"INFO","ts":"2022-06-18 10:45:01","file":"gin@v1.7.4/context.go:165","msg":"/api/wechat_mp","status":200,"method":"POST","path":"/api/wechat_mp","query":"signature=88df4d6b46f61a085fe89836b84275f805b30c&timestamp=1655520301&nonce=1830400737&openid=oo5TywvvbagxO6TGpeTYa0o","ip":"81.69.103.0","user-agent":"Mozilla/4.0","time":"2022-06-18T02:45:01Z","latency":160,"trackId":"9745f19f-e928-4256-9400-864053ace90d"}`,
	`{"level":"INFO","ts":"2022-06-18 10:45:01","file":"gin@v1.7.4/context.go:165","msg":"/api/wechat_mp","status":200,"method":"POST","path":"/api/wechat_mp","query":"signature=88df4d6b46f61a085fe89836b84275f805b30c&timestamp=1655520301&nonce=1830400737&openid=oo5TywvvbagxO6TGpeTYa0o","ip":"81.69.103.0","user-agent":"Mozilla/4.0","time":"2022-06-18T02:45:01Z","latency":160,"trackId":"9745f19f-e928-4256-9400-864053ace90d"}`,
	`{"level":"INFO","ts":"2022-06-18 10:45:01","file":"gin@v1.7.4/context.go:165","msg":"/api/wechat_mp","status":200,"method":"POST","path":"/api/wechat_mp","query":"signature=88df4d6b46f61a085fe89836b84275f805b30c&timestamp=1655520301&nonce=1830400737&openid=oo5TywvvbagxO6TGpeTYa0o","ip":"81.69.103.0","user-agent":"Mozilla/4.0","time":"2022-06-18T02:45:01Z","latency":160,"trackId":"9745f19f-8888-4256-9400-864053ace90d"}`,
	`{"level":"INFO","ts":"2022-06-18 10:45:01","file":"gin@v1.7.4/context.go:165","msg":"/api/wechat_mp","status":200,"method":"POST","path":"/api/wechat_mp","query":"signature=88df4d6b46f61a085fe89836b84275f805b30c&timestamp=1655520301&nonce=1830400737&openid=oo5TywvvbagxO6TGpeTYa0o","ip":"81.69.103.0","user-agent":"Mozilla/4.0","time":"2022-06-18T02:45:01Z","latency":160,"trackId":"9745f19f-e928-4256-9400-864053ace90d"}`,
	`{"level":"INFO","ts":"2022-06-18 10:45:01","file":"gin@v1.7.4/context.go:165","msg":"/api/wechat_mp","status":200,"method":"POST","path":"/api/wechat_mp","query":"signature=88df4d6b46f61a085fe89836b84275f805b30c&timestamp=1655520301&nonce=1830400737&openid=oo5TywvvbagxO6TGpeTYa0o","ip":"81.69.103.0","user-agent":"Mozilla/4.0","time":"2022-06-18T02:45:01Z","latency":160,"trackId":"9745f19f-e928-4256-9400-864053ace90d"}`,
	`{"level":"INFO","ts":"2022-06-18 10:45:01","file":"gin@v1.7.4/context.go:165","msg":"/api/wechat_mp","status":200,"method":"POST","path":"/api/wechat_mp","query":"signature=88df4d6b46f61a085fe89836b84275f805b30c&timestamp=1655520301&nonce=1830400737&openid=oo5TywvvbagxO6TGpeTYa0o","ip":"81.69.103.0","user-agent":"Mozilla/4.0","time":"2022-06-18T02:45:01Z","latency":160,"trackId":"9745f19f-9999-4256-9400-864053ace90d"}`,
	`{"level":"INFO","ts":"2022-06-18 10:45:01","file":"gin@v1.7.4/context.go:165","msg":"/api/wechat_mp","status":200,"method":"POST","path":"/api/wechat_mp","query":"signature=88df4d6b46f61a085fe89836b84275f805b30c&timestamp=1655520301&nonce=1830400737&openid=oo5TywvvbagxO6TGpeTYa0o","ip":"81.69.103.0","user-agent":"Mozilla/4.0","time":"2022-06-18T02:45:01Z","latency":160,"trackId":"9745f19f-e928-4256-9400-864053ace90d"}`,
	`{"level":"INFO","ts":"2022-06-18 10:45:01","file":"gin@v1.7.4/context.go:165","msg":"/api/wechat_mp","status":200,"method":"POST","path":"/api/wechat_mp","query":"signature=88df4d6b46f61a085fe89836b84275f805b30c&timestamp=1655520301&nonce=1830400737&openid=oo5TywvvbagxO6TGpeTYa0o","ip":"81.69.103.0","user-agent":"Mozilla/4.0","time":"2022-06-18T02:45:01Z","latency":160,"trackId":"9745f19f-e928-4256-9400-864053ace90d"}`,
	`{"level":"INFO","ts":"2022-06-18 10:45:01","file":"gin@v1.7.4/context.go:165","msg":"/api/wechat_mp","status":200,"method":"POST","path":"/api/wechat_mp","query":"signature=88df4d6b46f61a085fe89836b84275f805b30c&timestamp=1655520301&nonce=1830400737&openid=oo5TywvvbagxO6TGpeTYa0o","ip":"81.69.103.0","user-agent":"Mozilla/4.0","time":"2022-06-18T02:45:01Z","latency":160,"trackId":"9745f19f-0000-4256-9400-864053ace90d"}`,
	`{"level":"INFO","ts":"2022-06-18 10:45:01","file":"gin@v1.7.4/context.go:165","msg":"/api/wechat_mp","status":200,"method":"POST","path":"/api/wechat_mp","query":"signature=88df4d6b46f61a085fe89836b84275f805b30c&timestamp=1655520301&nonce=1830400737&openid=oo5TywvvbagxO6TGpeTYa0o","ip":"81.69.103.0","user-agent":"Mozilla/4.0","time":"2022-06-18T02:45:01Z","latency":160,"trackId":"9745f19f-e928-4256-9400-864053ace90d"}`,
	`{"level":"INFO","ts":"2022-06-18 10:45:01","file":"gin@v1.7.4/context.go:165","msg":"/api/wechat_mp","status":200,"method":"POST","path":"/api/wechat_mp","query":"signature=88df4d6b46f61a085fe89836b84275f805b30c&timestamp=1655520301&nonce=1830400737&openid=oo5TywvvbagxO6TGpeTYa0o","ip":"81.69.103.0","user-agent":"Mozilla/4.0","time":"2022-06-18T02:45:01Z","latency":160,"trackId":"9745f19f-e928-4256-9400-864053ace90d"}`,
	`{"level":"INFO","ts":"2022-06-18 10:45:01","file":"gin@v1.7.4/context.go:165","msg":"/api/wechat_mp","status":200,"method":"POST","path":"/api/wechat_mp","query":"signature=88df4d6b46f61a085fe89836b84275f805b30c&timestamp=1655520301&nonce=1830400737&openid=oo5TywvvbagxO6TGpeTYa0o","ip":"81.69.103.0","user-agent":"Mozilla/4.0","time":"2022-06-18T02:45:01Z","latency":160,"trackId":"9745f19f-aaaa-4256-9400-864053ace90d"}`,
	`{"level":"INFO","ts":"2022-06-18 10:45:01","file":"gin@v1.7.4/context.go:165","msg":"/api/wechat_mp","status":200,"method":"POST","path":"/api/wechat_mp","query":"signature=88df4d6b46f61a085fe89836b84275f805b30c&timestamp=1655520301&nonce=1830400737&openid=oo5TywvvbagxO6TGpeTYa0o","ip":"81.69.103.0","user-agent":"Mozilla/4.0","time":"2022-06-18T02:45:01Z","latency":160,"trackId":"9745f19f-e928-4256-9400-864053ace90d"}`,
	`{"level":"INFO","ts":"2022-06-18 10:45:01","file":"gin@v1.7.4/context.go:165","msg":"/api/wechat_mp","status":200,"method":"POST","path":"/api/wechat_mp","query":"signature=88df4d6b46f61a085fe89836b84275f805b30c&timestamp=1655520301&nonce=1830400737&openid=oo5TywvvbagxO6TGpeTYa0o","ip":"81.69.103.0","user-agent":"Mozilla/4.0","time":"2022-06-18T02:45:01Z","latency":160,"trackId":"9745f19f-e928-4256-9400-864053ace90d"}`,
	`{"level":"INFO","ts":"2022-06-18 10:45:01","file":"gin@v1.7.4/context.go:165","msg":"/api/wechat_mp","status":200,"method":"POST","path":"/api/wechat_mp","query":"signature=88df4d6b46f61a085fe89836b84275f805b30c&timestamp=1655520301&nonce=1830400737&openid=oo5TywvvbagxO6TGpeTYa0o","ip":"81.69.103.0","user-agent":"Mozilla/4.0","time":"2022-06-18T02:45:01Z","latency":160,"trackId":"9745f19f-bbbb-4256-9400-864053ace90d"}`,
	`{"level":"INFO","ts":"2022-06-18 10:45:01","file":"gin@v1.7.4/context.go:165","msg":"/api/wechat_mp","status":200,"method":"POST","path":"/api/wechat_mp","query":"signature=88df4d6b46f61a085fe89836b84275f805b30c&timestamp=1655520301&nonce=1830400737&openid=oo5TywvvbagxO6TGpeTYa0o","ip":"81.69.103.0","user-agent":"Mozilla/4.0","time":"2022-06-18T02:45:01Z","latency":160,"trackId":"9745f19f-e928-4256-9400-864053ace90d"}`,
	`{"level":"INFO","ts":"2022-06-18 10:45:01","file":"gin@v1.7.4/context.go:165","msg":"/api/wechat_mp","status":200,"method":"POST","path":"/api/wechat_mp","query":"signature=88df4d6b46f61a085fe89836b84275f805b30c&timestamp=1655520301&nonce=1830400737&openid=oo5TywvvbagxO6TGpeTYa0o","ip":"81.69.103.0","user-agent":"Mozilla/4.0","time":"2022-06-18T02:45:01Z","latency":160,"trackId":"9745f19f-e928-4256-9400-864053ace90d"}`,
	`{"level":"INFO","ts":"2022-06-18 10:45:01","file":"gin@v1.7.4/context.go:165","msg":"/api/wechat_mp","status":200,"method":"POST","path":"/api/wechat_mp","query":"signature=88df4d6b46f61a085fe89836b84275f805b30c&timestamp=1655520301&nonce=1830400737&openid=oo5TywvvbagxO6TGpeTYa0o","ip":"81.69.103.0","user-agent":"Mozilla/4.0","time":"2022-06-18T02:45:01Z","latency":160,"trackId":"9745f19f-cccc-4256-9400-864053ace90d"}`,
	`{"level":"INFO","ts":"2022-06-18 10:45:01","file":"gin@v1.7.4/context.go:165","msg":"/api/wechat_mp","status":200,"method":"POST","path":"/api/wechat_mp","query":"signature=88df4d6b46f61a085fe89836b84275f805b30c&timestamp=1655520301&nonce=1830400737&openid=oo5TywvvbagxO6TGpeTYa0o","ip":"81.69.103.0","user-agent":"Mozilla/4.0","time":"2022-06-18T02:45:01Z","latency":160,"trackId":"9745f19f-dddd-4256-9400-864053ace90d"}`,
}

func TestLogPush(t *testing.T) {
	var logPush = logpush.LogPush{
		MaxPoolLength: 5,
		PushDuration:  time.Minute,
		Engine: &engines.Zinc{
			Index:    "test",                                  // edit this
			Url:      "https://playground.dev.zincsearch.com", // edit this
			Username: "admin",                                 // edit this
			Password: "Complexpass#123",                       // edit this
		},
	}
	for _, v := range testData {
		err := logPush.Push(v)
		if err != nil {
			fmt.Println(err)
		}
	}
}
